{if $smarty.request.detail < 4}
	<div id="builder">
		Use this form to generate the list of files you would like to view:
		<br />
		<form name="search" action="{$search_str|htmlspecialchars}" method="get">
            {foreach from=$smarty.get key=k item=v}
            {if $k != "search" && $k != "cat"}
                <input type="hidden" name="{$k}" value="{$v|htmlspecialchars}" />
            {/if}
            {/foreach}
			<select name="cat">
			{foreach item=name key=module from=$handlers}
				<option value="{$handler}" {if isset($cat) && $cat eq $handler}selected{/if}>{$name}</option>
			{/foreach}
			</select>
			<br />
			Contains <input name="search" type="text" value="{if isset($smarty.request.search)}{$smarty.request.search|htmlspecialchars}{/if}" /> (Enter keywords)
			<br />
			Submit to apply filter.
			<br />
			<input type="submit" value="Search" />
		</form>
	</div>
{elseif $smarty.request.detail >= 4}
	<div id="builder">
		Use this form to generate the list of files you would like to view:
		<br />
		<form name="search" action="{$search_str|htmlspecialchars}" method="get">
			<select name="cat">
			{section name=module loop=$handlers}
				{assign var=module value=$handlers[module]}
				<option value="{$handlers[module]}" {if isset($search.cat) && $search.cat eq $handlers[module]}selected{/if}>{php}
					$handler = $this->get_template_vars('handler');
					echo constant($handler . '::NAME');
				{/php}</option>
			{/section}
			</select>
			<br />
			Contains <input name="search" type="text" value="{if isset($search.search)}{$search.search}{/if}" /> (Enter keywords)
			<br />
			Directory <input name="dir" type="text" value="{if isset($search.dir)}{$search.dir}{/if}" /> (Directory filter)
			<br />
			Order by <select name="order_by">
				{section name=order_by loop=$columns}
				<option value="{$columns[order_by]}" {if isset($search.order_by) && $search.order_by eq $columns[order_by]}selected{/if}>{$columns[order_by]}</option>
				{/section}
			</select>
			<br />
			Submit to apply filter.
			<br />
			<input type="submit" value="Search" />
		</form>
	</div>
{/if}